(()=>{var e={27:(e,t,n)=>{function r(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}var{ALWAYS_ONLINE_TOGGLE:o,URI:i}=n(958),s=n(102);class c{constructor(){this.auth=null}static isAlwaysOnlineSelected(){return new Promise((e=>{chrome.storage.local.get(o,(function(t){t[o]?e(!0):e(!1)}))}))}pingOnline(){var e,t=this;return(e=function*(){if((yield c.isAlwaysOnlineSelected())&&t.auth){var e=yield s.getEndpoints();fetch(e[i.ALWAYS_ONLINE],{headers:{accept:"application/json","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/json; charset=utf-8","sec-ch-ua":'"Chromium";v="88", "Google Chrome";v="88", ";Not A Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-csrf-token":t.auth.authToken,"x-requested-with":"XMLHttpRequest"},referrer:"https://www.fiverr.com/users/".concat(t.auth.fiverUsername,"/seller_dashboard"),referrerPolicy:"strict-origin-when-cross-origin",body:'{"entity_id":"'.concat(t.auth.userId,'","platform":"web"}'),method:"POST",mode:"cors",credentials:"include"}).catch((e=>{console.error(e)}))}},function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function c(e){r(s,o,i,c,a,"next",e)}function a(e){r(s,o,i,c,a,"throw",e)}c(void 0)}))})()}setAuth(e){return this.auth=e,this}}e.exports=c},102:(e,t,n)=>{var{ACTIVE_USER:r,API:o,URI_DATA:i,USER_DETAILS:s}=n(958);e.exports=class{static isActive(){return new Promise((e=>{chrome.storage.local.get(r,(function(t){e(t[r])}))}))}static checkActive(){return new Promise((e=>{fetch(o.BASE+o.ACTIVE_ENDPOINT).then((e=>e.json())).then((t=>{t.paid?e(!0):e(!1)})).catch((t=>{e(!1),console.error(t)}))}))}static Authorize(){return new Promise((e=>{fetch(o.BASE+o.AUTHORIZE_ENDPOINT).then((e=>e.json())).then((e=>{e.paid?(chrome.storage.local.set({[r]:!0}),chrome.storage.local.set({[i]:e.endpoints})):chrome.storage.local.remove([i,r])})).catch((e=>{console.error(e)}))}))}static getEndpoints(){return new Promise((e=>{chrome.storage.local.get(i,(function(t){t[i]?e(t[i]):e({})}))}))}static getAuthValues(){return new Promise((e=>{chrome.storage.local.get(s,(function(t){t[s]?e({authToken:t[s].authToken,fiverUserName:t[s].fiverUserName,userId:t[s].userId}):e(!1)}))}))}}},606:(e,t,n)=>{function r(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function c(e){r(s,o,i,c,a,"next",e)}function a(e){r(s,o,i,c,a,"throw",e)}c(void 0)}))}}var{AUTO_RESPONDER_TOGGLE:i,USER_PREFERENCE:s,URI:c,NOTIFICATIONS:a}=n(958),u=n(102),E=n(243);class _{constructor(){this.toBeSent=[],this.toBeSentUsers=new Set}static getTemplate(){return new Promise((e=>{chrome.storage.local.get(s,(function(t){var n=t[s];e(!!n&&n.responderMessage)}))}))}static isAutoResponderSelected(){return new Promise((e=>{chrome.storage.local.get(i,(function(t){t[i]?e(!0):e(!1)}))}))}autoRespond(){var e=this;return o((function*(){if(yield _.isAutoResponderSelected()){var t=yield u.getEndpoints();try{for(var n=yield(yield fetch(t[c.AUTO_RESPONDER_CONTACTS])).json(),r=0;r<=10;r++)n[r]&&n[r].firstInteraction&&!e.toBeSentUsers.has(n[r].username)&&(e.toBeSent.push(n[r]),e.toBeSentUsers.add(n[r].username));if(e.toBeSent.length<1)return;e.openSenderTab()}catch(e){}}}))()}openSenderTab(){chrome.tabs.create({url:"https://www.fiverr.com/inbox#send_message",pinned:!0})}static notify(e){chrome.notifications.clear(a.AUTO_RESPONDER_ID,(function(){E.notify(a.AUTO_RESPONDER_ID,e)}))}getMessages(){var e=this;return o((function*(){var t=yield _.getTemplate(),n="Welcome user,\n        ".concat(t,"\n        ");return e.toBeSent.map((e=>({username:e.username,message:"".concat(n).replace("user",e.username)})))}))()}clearTobeSent(){_.notify({type:"basic",iconUrl:"/icon48.png",title:"Autoresponded to ".concat(this.toBeSent.length," messages"),message:"We've autoresponded to ".concat(this.toBeSent.length," messages, check them out")}),this.toBeSent=[];var e=document.querySelector("#only_iframe");e&&e.remove()}}e.exports=_},829:(e,t,n)=>{function r(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function c(e){r(s,o,i,c,a,"next",e)}function a(e){r(s,o,i,c,a,"throw",e)}c(void 0)}))}}var{URI:i,FIVERR_NOTIFICATION_TOGGLE:s,TRACKER:c,NOTIFICATIONS:a}=n(958),u=n(102),E=n(243),_=n(423);class T{static isNotificationSelected(){return new Promise((e=>{chrome.storage.local.get(s,(function(t){t[s]?e(!0):e(!1)}))}))}static clearNotification(){return new Promise((e=>{chrome.notifications.clear(a.BETTER_NOTIFICATION_ID,(function(){e(!0)}))}))}static createNotification(e){return o((function*(){yield T.clearNotification(),E.notify(a.BETTER_NOTIFICATION_ID,e),_.update(c.NUM_OF_BETTER_NOTIFICATIONS)}))()}static checkNotifiction(){return o((function*(){if(yield T.isNotificationSelected()){var e=yield u.getEndpoints();try{var t=yield(yield fetch(e[i.BETTER_SPECIFIC_NOTIFICATION])).json();return t.inbox_unseen&&t.notifications_unseen?T.createNotification({type:"basic",iconUrl:"/icon48.png",title:"".concat(t.inbox_unseen_count," Messages & ").concat(t.notifications_unseen_count," Notifications unseen"),message:"You have ".concat(t.inbox_unseen_count," Messages & ").concat(t.notifications_unseen_count," Notifications unseen on Fiverr")}):t.inbox_unseen?T.createNotification({type:"basic",iconUrl:"/icon48.png",title:"".concat(t.inbox_unseen_count," Unread Messages"),message:"You have ".concat(t.inbox_unseen_count," Messages unread on Fiverr")}):t.notifications_unseen&&T.createNotification({type:"basic",iconUrl:"/icon48.png",title:"".concat(t.notifications_unseen_count," Unread Notifications"),message:"You have ".concat(t.notifications_unseen_count," Notifications unread on Fiverr")}),!!t.inbox_unseen}catch(e){}}}))()}}e.exports=T},243:(e,t,n)=>{function r(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function c(e){r(s,o,i,c,a,"next",e)}function a(e){r(s,o,i,c,a,"throw",e)}c(void 0)}))}}var{NOTIFICATION_SOUNDS:i}=n(958);class s{static create(e){}static setSound(e){chrome.storage.local.set({[i.NOTIFICATION_SOUNDS_KEY]:e})}static getSound(){return o((function*(){return new Promise((e=>{chrome.storage.local.get(i.NOTIFICATION_SOUNDS_KEY,(t=>{t[i.NOTIFICATION_SOUNDS_KEY]?e(t[i.NOTIFICATION_SOUNDS_KEY]):s.setSound(i.GOT_IT_DONE),e(i.GOT_IT_DONE)}))}))}))()}static playSound(){return o((function*(){var e=yield s.getSound();new Audio(chrome.runtime.getURL("".concat(e.toLowerCase(),".mp3"))).play()}))()}static notify(e,t){t.silent=!0,chrome.notifications.create(e,t),s.playSound()}}e.exports=s},627:(e,t,n)=>{function r(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}var{VISITED_IDS:o,BUYER_REQUEST_TOGGLE:i,USER_PREFERENCE:s,TRACKER:c,NOTIFICATIONS:a}=n(958),u=n(243),E=n(423);class _{constructor(){this.auth=null}static getQueries(){return new Promise((e=>{chrome.storage.local.get(s,(function(t){var n=t[s];e(n?n.buyerRequestQuery[0]:"")}))}))}static isRequestNotificationSelected(){return new Promise((e=>{chrome.storage.local.get(i,(function(t){t[i]?e(!0):e(!1)}))}))}getRequestNoti(){var e,t=this;return(e=function*(){(yield _.isRequestNotificationSelected())&&t.auth&&fetch("https://www.fiverr.com/users/".concat(t.auth.fiverUserName,"/requests?current_filter=active&page=1&per_page=100"),{headers:{accept:"text/javascript","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-csrf-token":t.auth.authToken,"x-requested-with":"XMLHttpRequest"},referrer:"https://www.fiverr.com/users/".concat(t.auth.fiverUserName,"/requests"),referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then((e=>e.json())).then((e=>{var t=e.results.rows;try{var n=t.map((e=>({id:e.identifier,date:e.cells[0].text,budget:e.cells[5].text,request:e.cells[5].buttons[1].meta.requestText,duration:e.cells[4].text,offers:e.cells[3].text})));_.sendBuyerNoti(n)}catch(e){}})).catch(console.error)},function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function c(e){r(s,o,i,c,a,"next",e)}function a(e){r(s,o,i,c,a,"throw",e)}c(void 0)}))})()}setAuth(e){return this.auth=e,this}static sendBuyerNoti(e){var t=e;chrome.storage.local.get(o,(function(n){var r=n[o];r&&(t=e.filter((e=>!r[e.id]))),t.forEach((e=>{u.notify(a.BUYER_REQUEST_ID+e.id,{type:"basic",iconUrl:"/icon48.png",title:e.budget+" Buyer Request",message:e.date+"\n"+e.offers+" offers,"+e.duration+" ago\n"+e.request}),E.update(c.NUM_OF_REQUEST_NOTIFICATIONS)})),r||(r={}),t.forEach((e=>{r[e.id]=!0})),chrome.storage.local.set({[o]:r})}))}}e.exports=_},423:(e,t,n)=>{function r(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function c(e){r(s,o,i,c,a,"next",e)}function a(e){r(s,o,i,c,a,"throw",e)}c(void 0)}))}}var{API:i,TRACKER:s}=n(958),c=n(102);class a{static ping(){return o((function*(){try{yield fetch(i.BASE+i.PING)}catch(e){console.log("Ping failed")}}))()}static getData(){return o((function*(){var e=yield c.getAuthValues();return new Promise((t=>{chrome.storage.local.get(s.TRACKER_STORAGE_KEY,(n=>{var r={};n[s.TRACKER_STORAGE_KEY]&&(r=n[s.TRACKER_STORAGE_KEY]),r.version=chrome.runtime.getManifest().version,r.fiverUserName=e.fiverUserName,t(r)}))}))}))()}static update(e){return o((function*(){var t=yield a.getData(),n=0;t[e]&&(n=t[e]),t[e]=++n,chrome.storage.local.set({[s.TRACKER_STORAGE_KEY]:t})}))()}static sendData(){return o((function*(){try{var e=yield a.getData();if(Object.values(e).length<1)return;yield fetch(i.BASE+i.TRACKER_DATA_ENDPOINT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){console.log("t data sending failed!")}}))()}}e.exports=a},958:e=>{e.exports={SEND_BUYER_REQUESTS:"SEND_BUYER_REQUESTS",VISITED_IDS:"VISITED_IDS",USER_DETAILS:"USER_DETAILS",GET_MESSAGES:"GET_MESSAGES",BUYER_REQUEST_TOGGLE:"BUYER_REQUEST_TOGGLE",ALWAYS_ONLINE_TOGGLE:"ALWAYS_ONLINE_TOGGLE",AUTO_RESPONDER_TOGGLE:"AUTO_RESPONDER_TOGGLE",FIVERR_NOTIFICATION_TOGGLE:"FIVERR_NOTIFICATION_TOGGLE",MONEY_CALCULATOR_TOGGLE:"MONEY_CALCULATOR_TOGGLE",BLUR_INCOME_TOGGLE:"BLUR_INCOME_TOGGLE",CHECK_ACTIVENESS:"CHECK_ACTIVENESS",CHECK_MONEYCALC_SELECTED:"CHECK_MONEYCALC_SELECTED",USER_PREFERENCE:"USER_PREFERENCE",ACTIVE_USER:"ACTIVE_USER",CLEAR_TOBESENT:"CLEAR_TOBESENT",URI_DATA:"URI_DATA",API:{BASE:"https://www.smartfiverr.com",ACTIVE_ENDPOINT:"/active",AUTHORIZE_ENDPOINT:"/authorize",PING:"/ping",TRACKER_DATA_ENDPOINT:"/tracker"},URI:{ALWAYS_ONLINE:"ALWAYS_ONLINE",AUTO_RESPONDER_CONTACTS:"AUTO_RESPONDER_CONTACTS",BETTER_NOTIFICATION:"BETTER_NOTIFICATION",BETTER_SPECIFIC_NOTIFICATION:"BETTER_SPECIFIC_NOTIFICATION"},TRACKER:{TRACKER_STORAGE_KEY:"TRACKER_STORAGE_KEY",NUM_OF_AUTORESPONDS:"NUM_OF_AUTORESPONDS",NUM_OF_BETTER_NOTIFICATIONS:"NUM_OF_BETTER_NOTIFICATIONS",NUM_OF_REQUEST_NOTIFICATIONS:"NUM_OF_REQUEST_NOTIFICATIONS",NUM_OF_MONEY_CALCULATOR_TRIGGERS:"NUM_OF_MONEY_CALCULATOR_TRIGGERS",NUM_OF_TIMES_POPUP_OPEN:"NUM_OF_TIMES_POPUP_OPEN",NUM_OF_TIMES_PREFERENCE_OPEN:"NUM_OF_TIMES_PREFERENCE_OPEN"},NOTIFICATIONS:{BETTER_NOTIFICATION_ID:"BETTER_NOTIFICATION_ID",AUTO_RESPONDER_ID:"AUTO_RESPONDER_ID",BUYER_REQUEST_ID:"BUYER_REQUEST_ID"},NOTIFICATION_SOUNDS:{NOTIFICATION_SOUNDS_KEY:"NOTIFICATION_SOUNDS_KEY",GOT_IT_DONE:"GOT_IT_DONE",MOONLESS:"MOONLESS",PIECE_OF_CAKE:"PIECE_OF_CAKE",POINT_BLANK:"POINT_BLANK",TO_THE_POINT:"TO_THE_POINT"}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{function e(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,i){var s=t.apply(n,r);function c(t){e(s,o,i,c,a,"next",t)}function a(t){e(s,o,i,c,a,"throw",t)}c(void 0)}))}}var{USER_DETAILS:r,CHECK_ACTIVENESS:o,GET_MESSAGES:i,USER_PREFERENCE:s,MONEY_CALCULATOR_TOGGLE:c,CHECK_MONEYCALC_SELECTED:a,CLEAR_TOBESENT:u,TRACKER:E,NOTIFICATIONS:_}=n(958),T=n(102),l=new(n(27)),O=new(n(606)),N=n(829),I=n(423),h=new(n(627));function f(){chrome.tabs.getAllInWindow(null,(function(e){for(var t=0;t<e.length;t++){var n=e[t];n.url.search("fiverr.com")>-1&&chrome.tabs.reload(n.id,{})}}))}T.Authorize(),chrome.runtime.onInstalled.addListener((function(e){"install"===e.reason?(chrome.storage.local.set({[s]:{responderMessage:"Thanks for reaching out.",buyerRequestQuery:[]}}),f(),chrome.tabs.create({url:"https://www.smartfiverr.com/welcome"})):"update"===e.reason&&f()})),chrome.runtime.onMessage.addListener((function(e,t,n){return e.type===r?chrome.storage.local.set({[r]:e.data}):e.type===i?O.getMessages().then((e=>{n({messages:e})})):e.type===o?T.isActive().then((e=>{n({isActive:e})})):e.type===a?chrome.storage.local.get(c,(function(e){e&&e[c]?(I.update(E.NUM_OF_MONEY_CALCULATOR_TRIGGERS),n({isActive:!0})):n({isActive:!1})})):e.type===u&&(O.clearTobeSent(),I.update(E.NUM_OF_AUTORESPONDS),n({done:!0})),!0})),chrome.webRequest.onHeadersReceived.addListener((function(e){var t=e.responseHeaders,n=t.findIndex((e=>"x-frame-options"===e.name.toLowerCase()));return-1!==n&&t.splice(n,1),{responseHeaders:t}}),{urls:["*://*.fiverr.com/*"],types:["main_frame","sub_frame"]},["blocking","responseHeaders"]),chrome.notifications.onClicked.addListener(function(){var e=t((function*(e){if(e===_.BETTER_NOTIFICATION_ID)chrome.tabs.create({url:"https://www.fiverr.com"});else if(e===_.AUTO_RESPONDER_ID)chrome.tabs.create({url:"https://www.fiverr.com/inbox"});else if(e.search(_.BUYER_REQUEST_ID)>-1){var t=yield T.getAuthValues();chrome.tabs.create({url:"https://www.fiverr.com/users/".concat(t.fiverUserName,"/requests")})}}));return function(t){return e.apply(this,arguments)}}());var S=1;setInterval(t((function*(){var e=yield T.getAuthValues(),t=yield T.isActive();e&&t&&(S%10==0&&(h.setAuth(e).getRequestNoti(),I.sendData()),S%2==0&&(l.setAuth(e).pingOnline(),(yield N.checkNotifiction())&&O.autoRespond(),I.ping()),S++)})),6e4),chrome.tabs.onUpdated.addListener((function(e,t,n){"complete"===t.status&&n.url&&"".concat(n.url).search("smartfiverr.com")>0&&T.Authorize()}))})()})();